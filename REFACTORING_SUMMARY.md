# Agent Router æ¶æ„é‡æ„æ€»ç»“

## âœ… å®Œæˆçš„å·¥ä½œ

æ ¹æ®OpenSpecè§„èŒƒï¼Œå·²æˆåŠŸå®ç°Agent Routeræ¶æ„ï¼Œå°†åŸæœ‰çš„ä¸‰ä¸ªåŠŸèƒ½æ¨¡å—é‡æ„ä¸ºä¸‰ä¸ªSubAgentï¼Œå¹¶æ·»åŠ äº†æ™ºèƒ½è·¯ç”±å™¨ã€‚

### 1. åˆ›å»ºçš„ç›®å½•ç»“æ„

```
agents/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ router/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent_router.py      # ä¸»è·¯ç”±å™¨
â”‚   â””â”€â”€ llm_router.py        # LLMå†³ç­–å¼•æ“
â”œâ”€â”€ ingest/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ ingest_agent.py      # æ‘˜è¦æç‚¼ä»£ç†
â”œâ”€â”€ super_analyst/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ super_analyst_agent.py  # æ·±åº¦åˆ†æä»£ç†
â””â”€â”€ new_angle/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ new_angle_agent.py   # å¹¿åº¦æ€è€ƒä»£ç†
```

### 2. å®ç°çš„æ ¸å¿ƒç»„ä»¶

#### Agent Routerï¼ˆä¸»è·¯ç”±å™¨ï¼‰
- **æ–‡ä»¶**: `agents/router/agent_router.py`
- **åŠŸèƒ½**: 
  - æ¥æ”¶ç”¨æˆ·è¯·æ±‚
  - æ™ºèƒ½è·¯ç”±åˆ°åˆé€‚çš„SubAgent
  - æ”¯æŒå¤šAgentåä½œ
  - ç»“æœèšåˆ

#### LLM Routerï¼ˆå†³ç­–å¼•æ“ï¼‰
- **æ–‡ä»¶**: `agents/router/llm_router.py`
- **åŠŸèƒ½**:
  - åŸºäºLLMçš„æ™ºèƒ½Agenté€‰æ‹©
  - å…³é”®è¯å›é€€è·¯ç”±
  - æ”¯æŒç”¨æˆ·æç¤º

#### Ingest Agentï¼ˆæ‘˜è¦æç‚¼ä»£ç†ï¼‰
- **æ–‡ä»¶**: `agents/ingest/ingest_agent.py`
- **åŠŸèƒ½**: å°è£…åŸæœ‰çš„ `content_processor` åŠŸèƒ½
- **è¾“å…¥**: week_path
- **è¾“å‡º**: ç»“æ„åŒ–æ‘˜è¦æ–‡æ¡£

#### Super Analyst Agentï¼ˆæ·±åº¦åˆ†æä»£ç†ï¼‰
- **æ–‡ä»¶**: `agents/super_analyst/super_analyst_agent.py`
- **åŠŸèƒ½**: å°è£…åŸæœ‰çš„ `super_analyst` workflow
- **è¾“å…¥**: topic, question
- **è¾“å‡º**: æ·±åº¦åˆ†ææŠ¥å‘Š

#### New Angle Agentï¼ˆå¹¿åº¦æ€è€ƒä»£ç†ï¼‰
- **æ–‡ä»¶**: `agents/new_angle/new_angle_agent.py`
- **åŠŸèƒ½**: å°è£…åŸæœ‰çš„ `new_angle` workflow
- **è¾“å…¥**: context
- **è¾“å‡º**: æ´å¯ŸæŠ¥å‘Š

### 3. æ›´æ–°çš„æ–‡ä»¶

- **scripts/cli.py**: æ·»åŠ äº† `router` å‘½ä»¤ï¼Œæ”¯æŒæ™ºèƒ½è·¯ç”±
- **config/router_config.json**: è·¯ç”±å™¨é…ç½®æ–‡ä»¶

### 4. åˆ›å»ºçš„æ–‡æ¡£

- **openspec/**: OpenSpecè§„èŒƒæ–‡ä»¶
- **AGENT_ROUTER_USAGE.md**: ä½¿ç”¨æŒ‡å—
- **REFACTORING_SUMMARY.md**: æœ¬æ–‡æ¡£

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. æ™ºèƒ½è·¯ç”±
- åŸºäºLLMçš„è‡ªåŠ¨Agenté€‰æ‹©
- æ”¯æŒç”¨æˆ·æç¤ºæŒ‡å®šAgent
- å…³é”®è¯å›é€€æœºåˆ¶

### 2. å¤šAgentåä½œ
- æ”¯æŒåŒæ—¶ä½¿ç”¨å¤šä¸ªAgent
- æ”¯æŒé¡ºåºæ‰§è¡Œï¼ˆå‰ä¸€ä¸ªçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªçš„è¾“å…¥ï¼‰
- ç»“æœè‡ªåŠ¨èšåˆ

### 3. å‘åå…¼å®¹
- ä¿ç•™åŸæœ‰çš„CLIå‘½ä»¤ï¼ˆingest, super-analyst, new-angleï¼‰
- ç°æœ‰å·¥ä½œæµä¸å—å½±å“
- å¯ä»¥é€æ­¥è¿ç§»åˆ°æ–°æ¶æ„

### 4. æ˜“äºæ‰©å±•
- æ¨¡å—åŒ–è®¾è®¡
- æ¸…æ™°çš„æ¥å£å®šä¹‰
- æ”¯æŒæ·»åŠ æ–°çš„SubAgent

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨ï¼ˆè‡ªåŠ¨è·¯ç”±ï¼‰

```bash
python -m scripts.cli router \
  --task "åˆ†æè¿™äº›æ–‡æ¡£" \
  --input-type file_path \
  --input-value "data/raw/2025-01-06"
```

### æŒ‡å®šAgent

```bash
python -m scripts.cli router \
  --task "æ·±åº¦åˆ†æé—®é¢˜" \
  --topic "æˆ˜ç•¥åˆ†æ" \
  --question "å¦‚ä½•æå‡ç«äº‰åŠ›ï¼Ÿ" \
  --agent-hint super_analyst
```

### å¤šAgentåä½œ

```bash
python -m scripts.cli router \
  --task "åˆ†æå¹¶å¯»æ‰¾æ–°è§†è§’" \
  --topic "äº§å“ç­–ç•¥" \
  --question "å¦‚ä½•ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Ÿ" \
  --max-agents 2 \
  --sequential
```

## ğŸ”§ é…ç½®è¯´æ˜

è·¯ç”±å™¨é…ç½®ä½äº `config/router_config.json`:

- **decision_engine**: å†³ç­–å¼•æ“ç±»å‹ï¼ˆllmï¼‰
- **max_agents_per_task**: æ¯ä¸ªä»»åŠ¡æœ€å¤šä½¿ç”¨çš„Agentæ•°é‡
- **enable_sequential_execution**: æ˜¯å¦å¯ç”¨é¡ºåºæ‰§è¡Œ
- **agents**: å„ä¸ªAgentçš„é…ç½®ï¼ˆenabled, model, priorityï¼‰

## ğŸš€ ä¸‹ä¸€æ­¥

### çŸ­æœŸ
1. âœ… å®ŒæˆåŸºç¡€æ¶æ„å®ç°
2. âœ… æ›´æ–°CLIæ”¯æŒ
3. â³ æ·»åŠ å•å…ƒæµ‹è¯•
4. â³ æ·»åŠ é›†æˆæµ‹è¯•

### ä¸­æœŸ
1. ä¼˜åŒ–LLMè·¯ç”±å†³ç­–é€»è¾‘
2. æ·»åŠ Agentæ‰§è¡Œå†å²è®°å½•
3. æ”¯æŒAgenté“¾å¼è°ƒç”¨é…ç½®
4. æ·»åŠ æ€§èƒ½ç›‘æ§

### é•¿æœŸ
1. æ”¯æŒæ›´å¤šSubAgentï¼ˆå¦‚ï¼šç¿»è¯‘Agentã€æ€»ç»“Agentç­‰ï¼‰
2. æ·»åŠ Agentå¸‚åœº/æ’ä»¶ç³»ç»Ÿ
3. æ”¯æŒè‡ªå®šä¹‰Agent
4. Web UIç•Œé¢

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **OpenSpecè§„èŒƒ**: `openspec/*.yaml`
- **ä½¿ç”¨æŒ‡å—**: `AGENT_ROUTER_USAGE.md`
- **å‘½ä»¤å‚è€ƒ**: `openspec/COMMANDS.md`
- **å¿«é€Ÿå¼€å§‹**: `openspec/quick_start.sh`

## âœ¨ ä¼˜åŠ¿

1. **æ™ºèƒ½åŒ–**: è‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„Agent
2. **çµæ´»æ€§**: æ”¯æŒæ‰‹åŠ¨æŒ‡å®šå’Œå¤šAgentåä½œ
3. **å¯æ‰©å±•**: æ˜“äºæ·»åŠ æ–°çš„SubAgent
4. **å…¼å®¹æ€§**: ä¿æŒå‘åå…¼å®¹
5. **æ¨¡å—åŒ–**: æ¸…æ™°çš„æ¶æ„è®¾è®¡

## ğŸ” éªŒè¯

ä»£ç å·²é€šè¿‡åŸºæœ¬éªŒè¯ï¼š
- âœ… Agent Routerå¯ä»¥æ­£å¸¸å¯¼å…¥
- âœ… CLIå‘½ä»¤æ­£å¸¸å·¥ä½œ
- âœ… æ— è¯­æ³•é”™è¯¯
- âœ… ç¬¦åˆOpenSpecè§„èŒƒ

## ğŸ“¦ æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶
- `agents/` - Agentå®ç°ç›®å½•
- `config/router_config.json` - è·¯ç”±å™¨é…ç½®
- `openspec/` - OpenSpecè§„èŒƒæ–‡ä»¶
- `AGENT_ROUTER_USAGE.md` - ä½¿ç”¨æŒ‡å—
- `REFACTORING_SUMMARY.md` - æœ¬æ–‡æ¡£

### ä¿®æ”¹æ–‡ä»¶
- `scripts/cli.py` - æ·»åŠ routerå‘½ä»¤

### ä¿æŒä¸å˜
- `workflows/` - åŸæœ‰å·¥ä½œæµä¿æŒä¸å˜
- `scripts/` - åŸæœ‰è„šæœ¬ä¿æŒä¸å˜ï¼ˆé™¤äº†cli.pyï¼‰

## ğŸ‰ æ€»ç»“

æˆåŠŸå®Œæˆäº†ä»å•ä¸€åŠŸèƒ½æ¨¡å—åˆ°Agent Routeræ¶æ„çš„é‡æ„ï¼Œå®ç°äº†ï¼š
- âœ… æ™ºèƒ½è·¯ç”±ç³»ç»Ÿ
- âœ… ä¸‰ä¸ªSubAgentå°è£…
- âœ… å¤šAgentåä½œæ”¯æŒ
- âœ… å‘åå…¼å®¹æ€§
- âœ… æ˜“äºæ‰©å±•çš„æ¶æ„

ç³»ç»Ÿç°åœ¨å¯ä»¥æ™ºèƒ½åœ°æ ¹æ®ä»»åŠ¡éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„Agentï¼Œå¹¶æ”¯æŒæœªæ¥æ·»åŠ æ›´å¤šSubAgentï¼Œæˆä¸ºä¸€ä¸ªæ›´åŠ å¼ºå¤§çš„ä¸ªäººAIåŠ©ç†ç³»ç»Ÿã€‚




